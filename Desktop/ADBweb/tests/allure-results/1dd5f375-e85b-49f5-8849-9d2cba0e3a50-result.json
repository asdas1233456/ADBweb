{"name": "测试外键一致性", "status": "failed", "statusDetails": {"message": "Failed: 发现 43 个定时任务的外键无效", "trace": "self = <test_comprehensive.TestDataConsistency object at 0x000001C03B84B990>\ndb_connection = <sqlite3.Connection object at 0x000001C03BBCBA60>\n\n    @allure.story(\"外键一致性\")\n    @allure.title(\"测试外键一致性\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    def test_foreign_key_consistency(self, db_connection):\n        \"\"\"测试外键一致性\"\"\"\n        cursor = db_connection.cursor()\n    \n        with allure.step(\"检查定时任务外键\"):\n            cursor.execute(\"\"\"\n                SELECT st.id, st.script_id, st.device_id\n                FROM scheduled_task st\n                LEFT JOIN script s ON st.script_id = s.id\n                LEFT JOIN device d ON st.device_id = d.id\n                WHERE s.id IS NULL OR d.id IS NULL\n            \"\"\")\n            invalid_tasks = cursor.fetchall()\n    \n            if invalid_tasks:\n                error_msg = f\"发现 {len(invalid_tasks)} 个定时任务的外键无效\"\n                allure.attach(str(invalid_tasks), \"无效外键\", allure.attachment_type.TEXT)\n>               pytest.fail(error_msg)\nE               Failed: 发现 43 个定时任务的外键无效\n\ntest_comprehensive.py:820: Failed"}, "description": "测试外键一致性", "steps": [{"name": "检查定时任务外键", "status": "failed", "statusDetails": {"message": "Failed: 发现 43 个定时任务的外键无效\n", "trace": "  File \"C:\\Users\\ddd\\Desktop\\ADBweb\\tests\\test_comprehensive.py\", line 820, in test_foreign_key_consistency\n    pytest.fail(error_msg)\n  File \"C:\\Users\\ddd\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\_pytest\\outcomes.py\", line 198, in fail\n    raise Failed(msg=reason, pytrace=pytrace)\n"}, "attachments": [{"name": "无效外键", "source": "637779ae-1715-4fb4-94d6-a0c4ca139767-attachment.txt", "type": "text/plain"}], "start": 1772039218358, "stop": 1772039218361}], "attachments": [{"name": "失败详情", "source": "8f066308-06f6-445c-b51e-f2900349e118-attachment.txt", "type": "text/plain"}, {"name": "执行时长", "source": "00bb597d-99f5-448d-9939-1530628141a4-attachment.txt", "type": "text/plain"}], "start": 1772039218358, "stop": 1772039218362, "uuid": "b2759b52-bea3-4113-aba5-c8a91758b9ea", "historyId": "29168fcb930681e24792b396690298e8", "testCaseId": "29168fcb930681e24792b396690298e8", "fullName": "test_comprehensive.TestDataConsistency#test_foreign_key_consistency", "labels": [{"name": "test_case", "value": "test_foreign_key_consistency"}, {"name": "tag", "value": "foreign"}, {"name": "story", "value": "外键一致性"}, {"name": "severity", "value": "critical"}, {"name": "feature", "value": "数据一致性"}, {"name": "suite", "value": "test_comprehensive"}, {"name": "subSuite", "value": "TestDataConsistency"}, {"name": "host", "value": "LAPTOP-3V4QFELG"}, {"name": "thread", "value": "12180-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_comprehensive"}]}